<?xml version="1.0" encoding="utf-8"?>
<!-- ARCHIVO OPCIONAL: Vistas para agregar botones en tareas y proyectos -->
<!-- Para activar estas vistas, agrega este archivo al __manifest__.py en la sección 'data' -->
<odoo>
    
    <!-- Heredar vista de tarea para agregar botón de imágenes anotadas -->
    <record id="view_task_form_inherit_image_annotation" model="ir.ui.view">
        <field name="name">project.task.form.inherit.image.annotation</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_view_image_annotations" 
                        type="object" 
                        class="oe_stat_button" 
                        icon="fa-image">
                    <field name="image_annotation_count" widget="statinfo" string="Imágenes"/>
                </button>
            </xpath>
        </field>
    </record>

    <!-- Agregar notebook tab en la tarea para las imágenes -->
    <record id="view_task_form_inherit_image_annotation_notebook" model="ir.ui.view">
        <field name="name">project.task.form.inherit.image.annotation.notebook</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Imágenes Anotadas" name="image_annotations">
                    <field name="image_annotation_ids">
                        <kanban>
                            <field name="id"/>
                            <field name="name"/>
                            <field name="image"/>
                            <field name="annotation_count"/>
                            <templates>
                                <t t-name="kanban-box">
                                    <div class="oe_kanban_global_click">
                                        <div class="o_kanban_image">
                                            <img t-att-src="kanban_image('project.image.annotation', 'image', record.id.raw_value)" 
                                                 alt="Imagen" class="o_image_64_cover"/>
                                        </div>
                                        <div class="oe_kanban_details">
                                            <strong class="o_kanban_record_title">
                                                <field name="name"/>
                                            </strong>
                                            <div>
                                                <i class="fa fa-map-marker"/> 
                                                <field name="annotation_count"/> anotaciones
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </templates>
                        </kanban>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Heredar vista de proyecto para agregar botón de imágenes anotadas -->
    <record id="view_project_form_inherit_image_annotation" model="ir.ui.view">
        <field name="name">project.project.form.inherit.image.annotation</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_view_image_annotations" 
                        type="object" 
                        class="oe_stat_button" 
                        icon="fa-image">
                    <field name="image_annotation_count" widget="statinfo" string="Imágenes"/>
                </button>
            </xpath>
        </field>
    </record>

    <!-- Agregar notebook tab en el proyecto para las imágenes -->
    <record id="view_project_form_inherit_image_annotation_notebook" model="ir.ui.view">
        <field name="name">project.project.form.inherit.image.annotation.notebook</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Imágenes Anotadas" name="image_annotations">
                    <field name="image_annotation_ids">
                        <kanban>
                            <field name="id"/>
                            <field name="name"/>
                            <field name="image"/>
                            <field name="annotation_count"/>
                            <templates>
                                <t t-name="kanban-box">
                                    <div class="oe_kanban_global_click">
                                        <div class="o_kanban_image">
                                            <img t-att-src="kanban_image('project.image.annotation', 'image', record.id.raw_value)" 
                                                 alt="Imagen" class="o_image_64_cover"/>
                                        </div>
                                        <div class="oe_kanban_details">
                                            <strong class="o_kanban_record_title">
                                                <field name="name"/>
                                            </strong>
                                            <div>
                                                <i class="fa fa-map-marker"/> 
                                                <field name="annotation_count"/> anotaciones
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </templates>
                        </kanban>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

</odoo>
