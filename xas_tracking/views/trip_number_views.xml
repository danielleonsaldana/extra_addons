<?xml version="1.0" encoding="UTF-8"?>

<odoo>
    <data noupdate="0">

        <!-- Vista kanban de número de viaje -->
        <record id="trip_number_kanban_view" model="ir.ui.view">
            <field name="name">trip_number.kanban.view</field>
            <field name="model">trip.number</field>
            <field name="arch" type="xml">
                <kanban default_group_by="state" create="true" edit="true">
                    <field name="name"/>
                    <field name="xas_partner_id"/>
                    <field name="state"/>
                    <field name="kanban_state"/>
                    <field name="color"/>
                    <field name="xas_way"/>
                    <progressbar field="kanban_state" colors="{&quot;normal&quot;: &quot;200&quot;, &quot;done&quot;: &quot;success&quot;, &quot;blocked&quot;: &quot;danger&quot;}"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="#{!selection_mode ? kanban_color(record.color.raw_value) : ''} oe_kanban_global_click">
                                <div class="o_kanban_record_details">
                                    <div class="o_kanban_record_top" name="kanban_top">
                                        <div class="o_kanban_record_headings" name="kanban_headings">
                                            <!-- <field name="is_priority" widget="boolean_favorite" nolabel="1"/> -->
                                            <strong class="o_kanban_record_title" name="kanban_title">
                                                <field name="name"/>
                                            </strong>
                                            <br/>
                                            <field name="xas_way"/>
                                            <field name="xas_partner_id"/>
                                        </div>
                                        <div class="o_dropdown_kanban dropdown">
                                            <a role="button" class="dropdown-toggle o-no-caret btn" data-bs-toggle="dropdown" data-display="static" href="#" aria-label="Menú desplegable" title="Menú desplegable">
                                                <span class="fa fa-ellipsis-v"/>
                                            </a>
                                            <div class="dropdown-menu" role="menu">
                                                <a t-if="widget.editable" role="menuitem" type="edit" class="dropdown-item">Editar</a>
                                                <a t-if="widget.deletable" role="menuitem" type="delete" class="dropdown-item">Eliminar</a>
                                                <ul class="oe_kanban_colorpicker" data-field="color"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="o_kanban_record_body" name="kanban_body">
                                        <!-- <field name="xas_purchase_ids"/> -->
                                    </div>
                                    <div class="o_kanban_record_bottom" name="kanban_bottom">
                                        <div class="oe_kanban_bottom_left" name="kanban_bottom_left"/>
                                        <div class="oe_kanban_bottom_right" name="kanban_bottom_right">
                                            <field name="kanban_state" widget="state_selection"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Vista busqueda de número de viaje -->
        <record id="trip_number_search_view" model="ir.ui.view">
            <field name="name">trip_number_search_view</field>
            <field name="model">trip.number</field>
            <field name="arch" type="xml">
                <search string="Busqueda de viajes">
                    <field name="name"/>
                    <field name="xas_partner_id"/>
                    <field name="state"/>
                    <field name="xas_way"/>
                    <field name="xas_tags_ids"/>

                    <!-- Filtro para registros activos -->
                    <filter string="Activos" name="active" domain="[('active','=',True)]"/>
                    <filter string="Inactivos" name="inactive" domain="[('active','=',False)]"/>

                    <!-- Agregar agrupadores -->
                    <group expand="0" string="Agrupar por">
                        <filter string="Proveedor" name="group_by_xas_partner_id" context="{'group_by':'xas_partner_id'}"/>
                        <filter string="Moneda" name="group_by_xas_currency_id" context="{'group_by':'xas_currency_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Vista tree de número de viaje -->
        <record model='ir.ui.view' id='trip_number_tree_view'>
            <field name='name'>trip_number_tree_view</field>
            <field name='model'>trip.number</field>
            <field name='arch' type='xml'>
                <tree string='Lista de viajes'>
                    <field name='name'/>
                    <field name="xas_partner_id"/>
                    <field name="xas_currency_id" invisible="1"/>
                    <field name="xas_value" invisible="1"/>
                    <field name="xas_tags_ids" widget="many2many_tags" invisible="1"/>
                </tree>
            </field>
        </record>

        <!-- Vista form de número de viaje -->
        <record model="ir.ui.view" id="trip_number_form_view">
            <field name="name">trip_number_form_view</field>
            <field name="model">trip.number</field>
            <field name="arch" type="xml">
                <form string="Formulario de número de viaje">
                    <header>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name" readonly="1" invisible="name == 'nuevo'"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="xas_tracking_id" invisible="1"/>
                                <field name="create_date" string="Fecha de creación" invisible="create_date == False"/>
                                <field name="xas_partner_id" force_save="1" readonly="context.get('default_xas_partner_id',False) or state == 'done'"/>
                                <field name="xas_way" force_save="1" readonly="xas_tracking_id" invisible="1"/>
                            </group>
                            <group>
                                <field name="xas_value" readonly="state == 'done'" invisible="1"/>
                                <field name="xas_tags_ids" widget="many2many_tags" readonly="state == 'done'" invisible="1"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter" name="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="message_ids"/>
                        <field name="activity_ids"/>
                    </div>
                </form>
            </field>
        </record>

    </data>
</odoo>